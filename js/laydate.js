/**
 
 @Name : layDate v1.1 日期控件
 @Author: 贤心
 @Date: 2014-06-25
 @QQ群：176047195
 @Site：http://sentsin.com/layui/laydate
 
 */
!function(h){var f={path:"",defSkin:"molv",format:"YYYY-MM-DD",min:"1900-01-01 00:00:00",max:"2099-12-31 23:59:59",isv:false};var e={},g=document,c="createElement",b="getElementById",d="getElementsByTagName";var a=["laydate_box","laydate_void","laydate_click","LayDateSkin","skins/","/laydate.css"];h.laydate=function(i){i=i||{};try{a.event=h.event?h.event:laydate.caller.arguments[0]}catch(j){}e.run(i);return laydate};laydate.v="1.1";e.getPath=(function(){var j=document.scripts,i=j[j.length-1].src;return f.path?f.path:i.substring(0,i.lastIndexOf("/")+1)}());e.use=function(j,k){var i=g[c]("link");i.type="text/css";i.rel="stylesheet";i.href=e.getPath+j+a[5];k&&(i.id=k);g[d]("head")[0].appendChild(i);i=null};e.trim=function(i){i=i||"";return i.replace(/^\s|\s$/g,"").replace(/\s+/g," ")};e.digit=function(i){return i<10?"0"+(i|0):i};e.stopmp=function(i){i=i||h.event;i.stopPropagation?i.stopPropagation():i.cancelBubble=true;return this};e.each=function(k,m){var l=0,j=k.length;for(;l<j;l++){if(m(l,k[l])===false){break}}};e.hasClass=function(j,i){j=j||{};return new RegExp("\\b"+i+"\\b").test(j.className)};e.addClass=function(j,i){j=j||{};e.hasClass(j,i)||(j.className+=" "+i);j.className=e.trim(j.className);return this};e.removeClass=function(k,i){k=k||{};if(e.hasClass(k,i)){var j=new RegExp("\\b"+i+"\\b");k.className=k.className.replace(j,"")}return this};e.removeCssAttr=function(k,i){var j=k.style;if(j.removeProperty){j.removeProperty(i)}else{j.removeAttribute(i)}};e.shde=function(j,i){j.style.display=i?"none":"block"};e.query=function(j){if(j&&j.nodeType===1){if(j.tagName.toLowerCase()!=="input"){throw new Error("选择器elem错误")}return j}var j=(e.trim(j)).split(" "),m=g[b](j[0].substr(1)),i;if(!m){return}else{if(!j[1]){return m}else{if(/^\./.test(j[1])){var l,n=j[1].substr(1),k=new RegExp("\\b"+n+"\\b");i=[];l=g.getElementsByClassName?m.getElementsByClassName(n):m[d]("*");e.each(l,function(o,p){k.test(p.className)&&i.push(p)});return i[0]?i:""}else{i=m[d](j[1]);return i[0]?m[d](j[1]):""}}}};e.on=function(j,k,i){j.attachEvent?j.attachEvent("on"+k,function(){i.call(j,h.even)}):j.addEventListener(k,i,false);return e};e.stopMosup=function(i,j){if(i!=="mouseup"){e.on(j,"mouseup",function(k){e.stopmp(k)})}};e.run=function(i){var j=e.query,k,o,n=a.event,m;try{m=n.target||n.srcElement||{}}catch(l){m={}}k=i.elem?j(i.elem):m;if(n&&m.tagName){if(!k||k===e.elem){return}e.stopMosup(n.type,k);e.stopmp(n);e.view(k,i);e.reshow()}else{o=i.event||"click";e.each((k.length|0)>0?k:[k],function(p,q){e.stopMosup(o,q);e.on(q,o,function(r){e.stopmp(r);if(q!==e.elem){e.view(q,i);e.reshow()}})})}};e.scroll=function(i){i=i?"scrollLeft":"scrollTop";return g.body[i]|g.documentElement[i]};e.winarea=function(i){return document.documentElement[i?"clientWidth":"clientHeight"]};e.isleap=function(i){return(i%4===0&&i%100!==0)||i%400===0};e.checkVoid=function(i,l,j){var k=[];i=i|0;l=l|0;j=j|0;if(i<e.mins[0]){k=["y"]}else{if(i>e.maxs[0]){k=["y",1]}else{if(i>=e.mins[0]&&i<=e.maxs[0]){if(i==e.mins[0]){if(l<e.mins[1]){k=["m"]}else{if(l==e.mins[1]){if(j<e.mins[2]){k=["d"]}}}}if(i==e.maxs[0]){if(l>e.maxs[1]){k=["m",1]}else{if(l==e.maxs[1]){if(j>e.maxs[2]){k=["d",1]}}}}}}}return k};e.timeVoid=function(j,i){if(e.ymd[1]+1==e.mins[1]&&e.ymd[2]==e.mins[2]){if(i===0&&(j<e.mins[3])){return 1}else{if(i===1&&j<e.mins[4]){return 1}else{if(i===2&&j<e.mins[5]){return 1}}}}else{if(e.ymd[1]+1==e.maxs[1]&&e.ymd[2]==e.maxs[2]){if(i===0&&j>e.maxs[3]){return 1}else{if(i===1&&j>e.maxs[4]){return 1}else{if(i===2&&j>e.maxs[5]){return 1}}}}}if(j>(i?59:23)){return 1}};e.check=function(){var j=e.options.format.replace(/YYYY|MM|DD|hh|mm|ss/g,"\\d+\\").replace(/\\$/g,"");var m=new RegExp(j),k=e.elem[a.elemv];var i=k.match(/\d+/g)||[],l=e.checkVoid(i[0],i[1],i[2]);if(k.replace(/\s/g,"")!==""){if(!m.test(k)){e.elem[a.elemv]="";e.msg("日期不符合格式，请重新选择。");return 1}else{if(l[0]){e.elem[a.elemv]="";e.msg("日期不在有效期内，请重新选择。");return 1}else{l.value=e.elem[a.elemv].match(m).join();i=l.value.match(/\d+/g);if(i[1]<1){i[1]=1;l.auto=1}else{if(i[1]>12){i[1]=12;l.auto=1}else{if(i[1].length<2){l.auto=1}}}if(i[2]<1){i[2]=1;l.auto=1}else{if(i[2]>e.months[(i[1]|0)-1]){i[2]=31;l.auto=1}else{if(i[2].length<2){l.auto=1}}}if(i.length>3){if(e.timeVoid(i[3],0)){l.auto=1}if(e.timeVoid(i[4],1)){l.auto=1}if(e.timeVoid(i[5],2)){l.auto=1}}if(l.auto){e.creation([i[0],i[1]|0,i[2]|0],1)}else{if(l.value!==e.elem[a.elemv]){e.elem[a.elemv]=l.value}}}}}};e.months=[31,null,31,30,31,30,31,31,30,31,30,31];e.viewDate=function(m,n,l){var j=e.query,k={},i=new Date();m<(e.mins[0]|0)&&(m=(e.mins[0]|0));m>(e.maxs[0]|0)&&(m=(e.maxs[0]|0));i.setFullYear(m,n,l);k.ymd=[i.getFullYear(),i.getMonth(),i.getDate()];e.months[1]=e.isleap(k.ymd[0])?29:28;i.setFullYear(k.ymd[0],k.ymd[1],1);k.FDay=i.getDay();k.PDay=e.months[n===0?11:n-1]-k.FDay+1;k.NDay=1;e.each(a.tds,function(q,r){var o=k.ymd[0],s=k.ymd[1]+1,p;r.className="";if(q<k.FDay){r.innerHTML=p=q+k.PDay;e.addClass(r,"laydate_nothis");s===1&&(o-=1);s=s===1?12:s-1}else{if(q>=k.FDay&&q<k.FDay+e.months[k.ymd[1]]){r.innerHTML=p=q-k.FDay+1;
if(q-k.FDay+1===k.ymd[2]){e.addClass(r,a[2]);k.thisDay=r}}else{r.innerHTML=p=k.NDay++;e.addClass(r,"laydate_nothis");s===12&&(o+=1);s=s===12?1:s+1}}if(e.checkVoid(o,s,p)[0]){e.addClass(r,a[1])}e.options.festival&&e.festival(r,s+"."+p);r.setAttribute("y",o);r.setAttribute("m",s);r.setAttribute("d",p);o=s=p=null});e.valid=!e.hasClass(k.thisDay,a[1]);e.ymd=k.ymd;a.year.value=e.ymd[0]+"年";a.month.value=e.digit(e.ymd[1]+1)+"月";e.each(a.mms,function(o,p){var q=e.checkVoid(e.ymd[0],(p.getAttribute("m")|0)+1);if(q[0]==="y"||q[0]==="m"){e.addClass(p,a[1])}else{e.removeClass(p,a[1])}e.removeClass(p,a[2]);q=null});e.addClass(a.mms[e.ymd[1]],a[2]);k.times=[e.inymd[3]|0||0,e.inymd[4]|0||0,e.inymd[5]|0||0];e.each(new Array(3),function(o){e.hmsin[o].value=e.digit(e.timeVoid(k.times[o],o)?e.mins[o+3]|0:k.times[o]|0)});e[e.valid?"removeClass":"addClass"](a.ok,a[1])};e.festival=function(k,i){var j;switch(i){case"1.1":j="元旦";break;case"3.8":j="妇女";break;case"4.5":j="清明";break;case"5.1":j="劳动";break;case"6.1":j="儿童";break;case"9.10":j="教师";break;case"10.1":j="国庆";break}j&&(k.innerHTML=j);j=null};e.viewYears=function(i){var j=e.query,k="";e.each(new Array(14),function(l){if(l===7){k+="<li "+(parseInt(a.year.value)===i?'class="'+a[2]+'"':"")+' y="'+i+'">'+i+"年</li>"}else{k+='<li y="'+(i-7+l)+'">'+(i-7+l)+"年</li>"}});j("#laydate_ys").innerHTML=k;e.each(j("#laydate_ys li"),function(l,m){if(e.checkVoid(m.getAttribute("y"))[0]==="y"){e.addClass(m,a[1])}else{e.on(m,"click",function(n){e.stopmp(n).reshow();e.viewDate(this.getAttribute("y")|0,e.ymd[1],e.ymd[2])})}})};e.initDate=function(){var j=e.query,k={},i=new Date();var l=e.elem[a.elemv].match(/\d+/g)||[];if(l.length<3){l=e.options.start.match(/\d+/g)||[];if(l.length<3){l=[i.getFullYear(),i.getMonth()+1,i.getDate()]}}e.inymd=l;e.viewDate(l[0],l[1]-1,l[2])};e.iswrite=function(){var i=e.query,j={time:i("#laydate_hms")};e.shde(j.time,!e.options.istime);e.shde(a.oclear,!("isclear" in e.options?e.options.isclear:1));e.shde(a.otoday,!("istoday" in e.options?e.options.istoday:1));e.shde(a.ok,!("issure" in e.options?e.options.issure:1))};e.orien=function(j,l){var k,i=e.elem.getBoundingClientRect();j.style.left=i.left+(l?0:e.scroll(1))+"px";if(i.bottom+j.offsetHeight/1.5<=e.winarea()){k=i.bottom-1}else{k=i.top>j.offsetHeight/1.5?i.top-j.offsetHeight+1:e.winarea()-j.offsetHeight}j.style.top=k+(l?0:e.scroll())+"px"};e.follow=function(i){if(e.options.fixed){i.style.position="fixed";e.orien(i,1)}else{i.style.position="absolute";e.orien(i)}};e.viewtb=(function(){var n,i=[],l=["日","一","二","三","四","五","六"];var j={},k=g[c]("table"),m=g[c]("thead");m.appendChild(g[c]("tr"));j.creath=function(o){var p=g[c]("th");p.innerHTML=l[o];m[d]("tr")[0].appendChild(p);p=null};e.each(new Array(6),function(o){i.push([]);n=k.insertRow(0);e.each(new Array(7),function(p){i[o][p]=0;o===0&&j.creath(p);n.insertCell(p)})});k.insertBefore(m,k.children[0]);k.id=k.className="laydate_table";n=i=null;return k.outerHTML.toLowerCase()}());e.view=function(l,i){var j=e.query,m,k={};i=i||l;e.elem=l;e.options=i;e.options.format||(e.options.format=f.format);e.options.start=e.options.start||"";e.mm=k.mm=[e.options.min||f.min,e.options.max||f.max];e.mins=k.mm[0].match(/\d+/g);e.maxs=k.mm[1].match(/\d+/g);a.elemv=/textarea|input/.test(e.elem.tagName.toLocaleLowerCase())?"value":"innerHTML";if(!e.box){m=g[c]("div");m.id=a[0];m.className=a[0];m.style.cssText="position: absolute;";m.setAttribute("name","laydate-v"+laydate.v);m.innerHTML=k.html='<div class="laydate_top">'+'<div class="laydate_ym laydate_y" id="laydate_YY">'+'<a class="laydate_choose laydate_chprev laydate_tab"><cite></cite></a>'+'<input id="laydate_y" readonly><label></label>'+'<a class="laydate_choose laydate_chnext laydate_tab"><cite></cite></a>'+'<div class="laydate_yms">'+'<a class="laydate_tab laydate_chtop"><cite></cite></a>'+'<ul id="laydate_ys"></ul>'+'<a class="laydate_tab laydate_chdown"><cite></cite></a>'+"</div>"+"</div>"+'<div class="laydate_ym laydate_m" id="laydate_MM">'+'<a class="laydate_choose laydate_chprev laydate_tab"><cite></cite></a>'+'<input id="laydate_m" readonly><label></label>'+'<a class="laydate_choose laydate_chnext laydate_tab"><cite></cite></a>'+'<div class="laydate_yms" id="laydate_ms">'+function(){var n="";e.each(new Array(12),function(o){n+='<span m="'+o+'">'+e.digit(o+1)+"月</span>"});return n}()+"</div>"+"</div>"+"</div>"+e.viewtb+'<div class="laydate_bottom">'+'<ul id="laydate_hms">'+'<li class="laydate_sj">时间</li>'+"<li><input readonly>:</li>"+"<li><input readonly>:</li>"+"<li><input readonly></li>"+"</ul>"+'<div class="laydate_time" id="laydate_time"></div>'+'<div class="laydate_btn">'+'<a id="laydate_clear">清空</a>'+'<a id="laydate_today">今天</a>'+'<a id="laydate_ok">确认</a>'+"</div>"+(f.isv?'<a href="http://sentsin.com/layui/laydate/" class="laydate_v" target="_blank">laydate-v'+laydate.v+"</a>":"")+"</div>";g.body.appendChild(m);e.box=j("#"+a[0]);e.events();m=null}else{e.shde(e.box)}e.follow(e.box);i.zIndex?e.box.style.zIndex=i.zIndex:e.removeCssAttr(e.box,"z-index");
e.stopMosup("click",e.box);e.initDate();e.iswrite();e.check()};e.reshow=function(){e.each(e.query("#"+a[0]+" .laydate_show"),function(j,k){e.removeClass(k,"laydate_show")});return this};e.close=function(){e.reshow();e.shde(e.query("#"+a[0]),1);e.elem=null};e.parse=function(j,i,k){j=j.concat(i);k=k||(e.options?e.options.format:f.format);return k.replace(/YYYY|MM|DD|hh|mm|ss/g,function(m,l){j.index=++j.index|0;return e.digit(j[j.index])})};e.creation=function(m,k){var j=e.query,l=e.hmsin;var i=e.parse(m,[l[0].value,l[1].value,l[2].value]);e.elem[a.elemv]=i;if(!k){e.close();typeof e.options.choose==="function"&&e.options.choose(i)}};e.cleardate=function(m,k){var j=e.query,l=e.hmsin;var i=e.parse(m,[l[0].value,l[1].value,l[2].value]);if(!k){e.close();typeof e.options.cleardate==="function"&&e.options.cleardate(i)}};e.events=function(){var i=e.query,j={box:"#"+a[0]};e.addClass(g.body,"laydate_body");a.tds=i("#laydate_table td");a.mms=i("#laydate_ms span");a.year=i("#laydate_y");a.month=i("#laydate_m");e.each(i(j.box+" .laydate_ym"),function(k,l){e.on(l,"click",function(m){e.stopmp(m).reshow();e.addClass(this[d]("div")[0],"laydate_show");if(!k){j.YY=parseInt(a.year.value);e.viewYears(j.YY)}})});e.on(i(j.box),"click",function(){e.reshow()});j.tabYear=function(k){if(k===0){e.ymd[0]--}else{if(k===1){e.ymd[0]++}else{if(k===2){j.YY-=14}else{j.YY+=14}}}if(k<2){e.viewDate(e.ymd[0],e.ymd[1],e.ymd[2]);e.reshow()}else{e.viewYears(j.YY)}};e.each(i("#laydate_YY .laydate_tab"),function(k,l){e.on(l,"click",function(m){e.stopmp(m);j.tabYear(k)})});j.tabMonth=function(k){if(k){e.ymd[1]++;if(e.ymd[1]===12){e.ymd[0]++;e.ymd[1]=0}}else{e.ymd[1]--;if(e.ymd[1]===-1){e.ymd[0]--;e.ymd[1]=11}}e.viewDate(e.ymd[0],e.ymd[1],e.ymd[2])};e.each(i("#laydate_MM .laydate_tab"),function(k,l){e.on(l,"click",function(m){e.stopmp(m).reshow();j.tabMonth(k)})});e.each(i("#laydate_ms span"),function(k,l){e.on(l,"click",function(m){e.stopmp(m).reshow();if(!e.hasClass(this,a[1])){e.viewDate(e.ymd[0],this.getAttribute("m")|0,e.ymd[2])}})});e.each(i("#laydate_table td"),function(k,l){e.on(l,"click",function(m){if(!e.hasClass(this,a[1])){e.stopmp(m);e.creation([this.getAttribute("y")|0,this.getAttribute("m")|0,this.getAttribute("d")|0])}})});a.oclear=i("#laydate_clear");e.on(a.oclear,"click",function(){e.elem[a.elemv]="";e.cleardate([])});a.otoday=i("#laydate_today");e.on(a.otoday,"click",function(){var k=new Date();e.creation([k.getFullYear(),k.getMonth()+1,k.getDate()])});a.ok=i("#laydate_ok");e.on(a.ok,"click",function(){if(e.valid){e.creation([e.ymd[0],e.ymd[1]+1,e.ymd[2]])}});j.times=i("#laydate_time");e.hmsin=j.hmsin=i("#laydate_hms input");j.hmss=["小时","分钟","秒数"];j.hmsarr=[];e.msg=function(k,m){var l='<div class="laydte_hsmtex">'+(m||"提示")+"<span>×</span></div>";if(typeof k==="string"){l+="<p>"+k+"</p>";e.shde(i("#"+a[0]));e.removeClass(j.times,"laydate_time1").addClass(j.times,"laydate_msg")}else{if(!j.hmsarr[k]){l+='<div id="laydate_hmsno" class="laydate_hmsno">';e.each(new Array(k===0?24:60),function(n){l+="<span>"+n+"</span>"});l+="</div>";j.hmsarr[k]=l}else{l=j.hmsarr[k]}e.removeClass(j.times,"laydate_msg");e[k===0?"removeClass":"addClass"](j.times,"laydate_time1")}e.addClass(j.times,"laydate_show");j.times.innerHTML=l};j.hmson=function(k,l){var m=i("#laydate_hmsno span"),n=e.valid?null:1;e.each(m,function(o,p){if(n){e.addClass(p,a[1])}else{if(e.timeVoid(o,l)){e.addClass(p,a[1])}else{e.on(p,"click",function(q){if(!e.hasClass(this,a[1])){k.value=e.digit(this.innerHTML|0)}})}}});e.addClass(m[k.value|0],"laydate_click")};e.each(j.hmsin,function(k,l){e.on(l,"click",function(m){e.stopmp(m).reshow();e.msg(k,j.hmss[k]);j.hmson(this,k)})});e.on(g,"mouseup",function(){var k=i("#"+a[0]);if(k&&k.style.display!=="none"){e.check()||e.close()}}).on(g,"keydown",function(l){l=l||h.event;var k=l.keyCode;if(k===13&&e.elem){e.creation([e.ymd[0],e.ymd[1]+1,e.ymd[2]])}})};e.init=(function(){e.use("need");e.use(a[4]+f.defSkin,a[3]);e.skinLink=e.query("#"+a[3])}());laydate.reset=function(){(e.box&&e.elem)&&e.follow(e.box)};laydate.now=function(j,k){var i=new Date((j|0)?function(l){return l<86400000?(+new Date+l*86400000):l}(parseInt(j)):+new Date);return e.parse([i.getFullYear(),i.getMonth()+1,i.getDate()],[i.getHours(),i.getMinutes(),i.getSeconds()],k)};laydate.skin=function(i){e.skinLink.href=e.getPath+a[4]+i+a[5]}}(window);
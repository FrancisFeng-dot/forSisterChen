window.root="index.php/",window.debugflag=0,window.lg=null,window.YSCONF={url:{getmenu:{url:"auth/menutree_select",method:"post_data",name:"后台侧边栏"},com_update:{url:"auth/com_editadd",method:"post_data_watch",name:"编辑更新一条"},com_list:{url:"auth/com_list",method:"post_data_watch",name:"无分页列表"},com_list2:{url:"auth/com_list",method:"post_data_watch",name:"无分页列表"},com_list3:{url:"auth/com_list",method:"post_data_watch",name:"无分页列表"},com_list4:{url:"auth/com_list",method:"post_data_watch",name:"无分页列表"},com_list5:{url:"auth/com_list",method:"post_data_watch",name:"无分页列表"},com_list6:{url:"auth/com_list",method:"post_data_watch",name:"无分页列表"},com_list_page:{url:"auth/com_list_page",method:"post_data_watch_page",name:"带分页列表"},com_list_page2:{url:"auth/com_list_page",method:"post_data_watch_page",name:"带分页列表",pageid:"page2"},com_list_page3:{url:"auth/com_list_page",method:"post_data_watch_page",name:"带分页列表"},com_detail:{url:"auth/com_detail",method:"post_data_watch",name:"详情"},com_detail2:{url:"auth/com_detail",method:"post_data_watch",name:"详情"},com_detail3:{url:"auth/com_detail",method:"post_data_watch",name:"详情"},com_del:{url:"auth/com_delete",method:"post_data_watch",name:"公共删除"},com_del2:{url:"auth/com_delete",method:"post_data_watch",name:"公共删除"},com_editadd:{url:"auth/com_editadd",method:"post_data_watch",name:"编辑或增加"},com_editadd2:{url:"auth/com_editadd",method:"post_data_watch",name:"编辑或增加"},com_editadd3:{url:"auth/com_editadd",method:"post_data_watch",name:"编辑或增加"},com_editadd4:{url:"auth/mycom_editadd",method:"post_data_watch",name:"编辑或增加"},com_editadd5:{url:"auth/com_editadd",method:"post_data_watch",name:"编辑或增加"},lgout:{url:"base/logout",method:"post_data_watch",name:"推出登录"}},win:{warmtips_teacher_set:{template:"warmtips_teacher_set",type:"add",title:"温馨提示",temdata:{}}}};var app=angular.module("myfact",[]);app.factory("fac",["$http",function($http){var f={time:function(e){var t=e?Date.parse(new Date(e)):Date.parse(new Date);return t},seturl:function(e,t){var a=YSCONF.url[t].url;a=e[t].url?e[t].url:a;var i=window.root+a,n=e[t].params||{};if(window.debugflag)switch(n.debug){case 1:var o=n.debugkey?"/"+n.debugkey:"";i="json/"+a+o+".json";break;case 0:i="json/err.json";break;case-2:i="json/noauth.json";break;case-1:i="json/nologin.json"}var c={url:i,method:YSCONF.url[t].method};return c},ysfetch:function(e,t){if(e&&t){var a=f.seturl(e,t);f[a.method](e,t)}},get:function(e,t,a){var i=e+"?token="+f.getstore("ystoken");$http({withCredentials:!0,method:"GET",params:$.param(t),url:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(e,t,i,n){e.code==-1?null==window.lg?f.lginbox():"":a(e)}).error(function(e,t,a,i){layer.msg("网络超时！",{icon:0,time:2e3})})},post:function(e,t,a){var i=e+"?token="+f.getstore("ystoken");$http({method:"POST",data:$.param(t),url:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(e,t,i,n){e.code==-1?null==window.lg?f.lginbox():"":a(e)}).error(function(e,t,a,i){layer.msg("网络超时！",{icon:0,time:2e3})})},lginbox:function(){layer.closeAll(),setTimeout(function(){window.lg=layer.open({type:1,title:!1,closeBtn:!1,shade:.8,id:"LAY_layuipro",resize:!1,btnAlign:"c",area:["738px","364px"],moveType:1,shade:!1,content:$(".login-box")})},200)},load:function(e){e?$("#loader").fadeIn(100):$("#loader").fadeOut(1e3)},getcode:function(){return $("#codeid").val()},get_data_watch:function(e,t){e&&t&&e.$watch(t+".time",function(){if(e[t].time){if("function"==typeof e[t].before){var a=e[t].before(e);if(a===!1)return!1}var i=e[t].params||{};YSCONF.url[t].load&&f.load(0);var n=f.seturl(e,t);f.get(n.url,i,function(a){e[t].data={},1==a.code&&(e[t].data=a.data),"function"==typeof e[t].done&&e[t].done(a,e),YSCONF.url[t].load&&f.load(0)})}},!0)},get_data_watch_page:function(e,t){if(e&&t){var a=YSCONF.url[t].pageid||"page";e.$watch(t+".time",function(){if(e[t].time){if("function"==typeof e[t].before){var i=e[t].before(e);if(i===!1)return!1}var n=e[t].params||{};YSCONF.url[t].load&&f.load(1);var o=f.seturl(e,t);f.get(o.url,n,function(i){e[t].data={},1==i.code&&(e[t].data=i.data,laypage({cont:a,pages:i.data.pages,skin:"molv",first:1,curr:e[t].params.curPage||1,prev:"<",next:">",jump:function(a,i){i||(e[t].params.curPage=a.curr,e[t].time=f.time(),e.$apply())}})),"function"==typeof e[t].done&&e[t].done(i,e),YSCONF.url[t].load&&f.load(0)})}},!0)}},get_data:function(e,t){if(e&&t){if("function"==typeof e[t].before){var a=e[t].before(e);if(a===!1)return!1}var i=e[t].params||{};YSCONF.url[t].load&&f.load(1);var n=f.seturl(e,t);f.get(n.url,i,function(a){e[t].data={},1==a.code&&(e[t].data=a.data),"function"==typeof e[t].done&&e[t].done(a,e),YSCONF.url[t].load&&f.load(0)})}},post_data_watch:function(e,t){e&&t&&e.$watch(t+".time",function(){if(e[t].time){if("function"==typeof e[t].before){var a=e[t].before(e);if(a===!1)return!1}var i=e[t].params||{};YSCONF.url[t].load&&f.load(1);var n=f.seturl(e,t);f.post(n.url,i,function(a){e[t].data={},1==a.code&&(e[t].data=a.data),"function"==typeof e[t].done&&e[t].done(a,e),YSCONF.url[t].load&&f.load(0)})}},!0)},post_data:function(e,t){if(e&&t){if("function"==typeof e[t].before){var a=e[t].before(e);if(a===!1)return!1}var i=e[t].params||{};YSCONF.url[t].load&&f.load(1);var n=f.seturl(e,t);f.post(n.url,i,function(a){e[t].data={},1==a.code&&(e[t].data=a.data),"function"==typeof e[t].done&&e[t].done(a,e),YSCONF.url[t].load&&f.load(0)})}},post_data_watch_page:function(e,t){if(e&&t){var a=YSCONF.url[t].pageid||"page";e.$watch(t+".time",function(){if(e[t].time){if("function"==typeof e[t].before){var i=e[t].before(e);if(i===!1)return!1}var n=e[t].params||{};YSCONF.url[t].load&&f.load(1);var o=f.seturl(e,t);f.post(o.url,n,function(i){e[t].data={},e[t].data=i.data,laypage({cont:a,pages:i.data.pages,skin:"molv",first:1,curr:e[t].params.curPage||1,prev:"<",next:">",jump:function(a,i){i||(e[t].params.curPage=a.curr,e[t].time=f.time(),e.$apply())}}),"function"==typeof e[t].done&&e[t].done(i,e),YSCONF.url[t].load&&f.load(0)})}},!0)}},getscope_byid:function(e,t){return e.$id==t?e:f.getscope_byid(e.$parent,t)},getcd:function(e,t){var a=f.getscope_byid(e,2);return a.cd[t]},setstore:function(e,t){return t="object"==typeof t?JSON.stringify(t):t,localStorage.setItem(e,t),!0},getstore:function(e){var t="";try{t=localStorage.getItem(e),t=JSON.parse(t)}catch(a){t=localStorage.getItem(e)}return t},unsetstore:function(e){return localStorage.removeItem(e),!0},getObjectURL:function(e){var t=null;return void 0!==window.createObjectURL?t=window.createObjectURL(e):void 0!==window.URL?t=window.URL.createObjectURL(e):void 0!==window.webkitURL&&(t=window.webkitURL.createObjectURL(e)),t},dogoto:function(e,t){layer.msg(e.msg),1==e.code&&setTimeout(function(){window.location.reload()},1e3)},setCookie:function(e,t){var a=new Date;a.setTime(a.getTime()+6048e5);var i="expires="+a.toUTCString();document.cookie=e+"="+t+"; "+i},getCookie:function(e){for(var t=e+"=",a=document.cookie.split(";"),i=0;i<a.length;i++){for(var n=a[i];" "==n.charAt(0);)n=n.substring(1);if(n.indexOf(t)!=-1)return n.substring(t.length,n.length)}return""},delCookie:function(e){f.setCookie(e,"",-1)},webupload:function(e,t,a,i,n,o,c,d){var r=WebUploader.create({resize:!1,swf:"YS-frame/webuploader/0.1.5/Uploader.swf",server:window.root+"base/upload",pick:"[name='picker']",chunked:!0,chunkSize:2097152,auto:!0});r.on("fileQueued",function(t){e.append('<div id="'+t.id+'" class="item"><p class="state">等待上传...</p></div>')}),r.on("uploadProgress",function(e,t,a){var i=$("#"+e.id),n=i.find(".progress .progress-bar");n.length||(n=$('<div class="progress progress-striped active" style="display:none;"><div class="progress-bar" role="progressbar" style="width: 0%"></div></div>').appendTo(i).find(".progress-bar"))}),r.on("uploadSuccess",function(e,t){if(1==t.code)if(t.url=t.url.replace(/\\/g,"/"),""!=$.trim(f.getstore("hash"))?(c=void 0!=f.getstore("hash").more?parseInt(f.getstore("hash").more):parseInt(c),n=void 0!=f.getstore("hash").key?f.getstore("hash").key:n,d=void 0!=f.getstore("hash").namefile?f.getstore("hash").namefile:d,f.setstore("hash").more="",f.setstore("hash").key="",f.setstore("hash").namefile=""):(c=c,n=n),i[n]=t.url,d&&(i[d]=t.oldname),1!=c){var a=n+"arr";if(i[a]=i[a]||[],i[a].length==c)return void layer.msg("超过最大上传图片数量");i[a].push(t.url);var r=[];if(i[a].map(function(e){r.push(e)}),i[n]=r.join(","),d){var s=d+"arr";i[s]=i[s]||[],i[s].push(t.oldname)}0==$(".jbimg-box").children("li").length&&($(".statusBar").removeClass("none"),$("#dndArea").addClass("none"),$("#filePicker").removeClass("none")),o.$apply()}else i[n]=t.url,"content"==n&&($("#fileList2").removeClass("none"),$("#imgparams2").removeClass("none")),"thumb"==n&&($("#fileList1").removeClass("none"),$("#imgparams1").removeClass("none"));else layer.msg(t.msg);$("#"+e.id).find("p.state").text("已上传")}),r.on("uploadError",function(e){$("#"+e.id).find("p.state").text("上传出错")}),r.on("uploadComplete",function(e){$("#"+e.id).find(".progress").fadeOut()}),r.on("fileQueued",function(e){if(""!=$.trim(f.getstore("hash")))var t=void 0!=f.getstore("hash").list?f.getstore("hash").list:"#fileList";else var t="#fileList";var a=$(t);$li=$('<div id="'+e.id+'" class="file-item thumbnail" style="border:0;height:100%;"><img style="width:100%;height:100%;"></div>'),$img=$li.find("img"),$(t).html(""),a.append($li),r.makeThumb(e,function(e,t){return e?void $img.replaceWith('<img style="width:100%;height:100%;" src="/images/transform.png">'):void $img.attr("src",t)},100,100)}),t.on("click",function(){return!$(this).hasClass("disabled")&&void r.upload()})},hashtoobj:function(e){var t={};if(e)if(e.indexOf("&")>0){var a=e.split("&");a.map(function(e){var a=e.split("=");a.length>1&&(t[a[0]]=a[1])})}else{var i=e.split("=");i.length>1&&(t[i[0]]=i[1])}return t},hashtoobj2:function(e){var t={};if(e)if(e.indexOf("&?!!?$")>0){var a=e.split("&?!!?$");a.map(function(e){var a=e.split("=");a.length>1&&(t[a[0]]=a[1])})}else{var i=e.split("=");i.length>1&&(t[i[0]]=i[1])}return t},dealneed:function(e,t){var a=e.id;$.ajax({url:"http://api.yushan.com/chat/needSend?token="+t,data:{toid:a},type:"POST",dataType:"json",success:function(e){}})},socketinit:function(sco){sco.socket=new WebSocket("ws://120.24.174.33:8484"),sco.socket.onopen=function(){var e='{"type":"init","uid":"'+user1.uid+'", "nickname":"'+user1.nickname+'","avatar":"'+user1.avatar+'"}';sco.socket.send(e),console.log("连接成功")},sco.socket.onerror=function(){console.log("连接失败")},sco.socket.onmessage=function(res){var data=eval("("+res.data+")");switch(data.message_type){case"ping":sco.socket.send('{"type":"ping"}');break;case"chatMessage":if(data.data.to.uid==user1.uid&&data.data.jobid!=user1.jobid){if(sco.com_editadd4.url="chat/needSend2",sco.com_editadd4.params.id=data.data.chatlogid,sco.com_editadd4.time=f.time(),data.data.content=f.replace_em(data.data.content),19!=data.data.chattype&&sco.chatsidebar.length>0)for(var i=sco.chatsidebar.length-1;i>=0;i--)sco.chatsidebar[i].jobid==data.data.jobid&&(data.data.content=f.replace_em(data.data.content),sco.chatsidebar[i].content=data.data.content,sco.chatsidebar[i].weidu++,sco.chatsidebar[i].createtime=data.data.createtime);sco.$apply()}if((data.data.to.uid==user1.uid||data.data.from.uid==user1.uid)&&data.data.jobid==user1.jobid){if(data.data.content=f.replace_em(data.data.content),data.data.timeline=f.getDateen(data.data.timeline),data.data.from_name=data.data.nickname,19!=data.data.chattype&&void 0!=sco.datalist&&(sco.datalist.push(data.data),setTimeout(function(){document.getElementById("chatwindow").scrollTop=document.getElementById("chatwindow").scrollHeight},100),sco.chatsidebar.length>0))for(var i=sco.chatsidebar.length-1;i>=0;i--)sco.chatsidebar[i].jobid==user1.jobid&&(sco.chatsidebar[i].content=data.data.content,sco.chatsidebar[i].createtime=data.data.createtime);sco.$apply()}break;case"logMessage":console.log(data.data)}}},setMessage:function(e,t,a){var i={mine:t,to:a},n={type:e,data:i};return n=JSON.stringify(n)},GetParentString:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(t);return a?unescape(a[2]):null},replace_em:function(e){return e=e.replace(/\</g,"&lt;"),e=e.replace(/\>/g,"&gt;"),e=e.replace(/\n/g,"<br/>"),e=e.replace(/\[em_([0-9]*)\]/g,'<img src="/images/face/$1.gif" border="0" />')},getDateen:function(e){var t=new Date(1e3*parseInt(e)).toLocaleString().substr(0,15);return t.split(" ")[1]},chatInit:function(){for(var e=(JSON.parse(JSON.stringify(chatv.chatlog)),0);e<chatv.chatlog.length;e++)chatv.chatlog[e].timeline=chatFn.getDateen(chatv.chatlog[e].timeline)},simpleClone:function(e){var t={};for(var a in e)t[a]=e[a];return t},testphone:function(e){var t=/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1})|(17[0-9]{1})|145|147|159|153)+\d{8})$/;return!!t.test(e)},sendImage:function(){var e={nickname:chatv.user1.nickname,mine:!0,avatar:chatv.user1.avatar,uid:chatv.user1.uid,content:chatv.chatlog[chatv.chatlog.length-1].content,chattype:this.GetParentString("chattype"),filetype:1},t={nickname:chatv.user2.nickname,avatar:chatv.user2.avatar,uid:chatv.user2.uid,avatar:chatv.user2.avatar,type:"privateChat"},a=chatFn.setMessage("chatMessage",e,t);socket.send(a)}};return f}]),app.filter("htmlfil",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]),app.filter("myfil",["fac",function(e){return function(e,t){var a=[];return angular.forEach(e,function(e,i){e.pid==t&&a.push(e)}),a}}]),app.controller("main_ctrl",["$scope","fac",function(e,t){function a(){var e=location.href.split("#");e=e[1]||"/index",e.indexOf("?")>0&&(t.setstore("hash",t.hashtoobj(e.split("?")[1])),e=e.split("?")[0]);var a=e.split("/");return a.shift(),e="./html/"+a.join("_"),e+".html?time="+t.time()}e.cd={},e.getmenu=[],$.ajax({type:"post",url:window.root+"open/menutree_select?token="+t.getstore("ystoken"),data:{debug:0},async:!1,success:function(t){e.getmenu.data=t.data,e.cd=t.arr}}),e.we="",$.ajax({type:"post",url:window.root+"open/islogin?token="+t.getstore("ystoken"),async:!1,success:function(t){e.we=t.code}}),e.ysmid=e.$id,e.lgout={done:function(e,a){t.unsetstore("ystoken"),window.location.href="/admin.php"}},t.ysfetch(e,"lgout"),e.findchk=function(e,t){var a=t.split(","),i=!1;return a.map(function(t){e==t&&(i=!0)}),i},e.body={url:a()},window.onhashchange=function(){e.body.url=a(),window.location.reload()},e.mainshow=0}]),app.controller("com_ctrl",["$scope","fac","hdl",function(e,t,a){e.yscid=e.$id,e.count=function(){e.len=e.com_editadd.params.specialty.length},e.workcount=function(){e.worklen=e.com_editadd.params.description.length},e.studycount=function(){e.studylen=e.com_editadd.params.description.length},e.procount=function(){e.prolen=e.com_editadd.params.description.length},e.city=function(e){SelCity(this,e)},e.com_update={time:0,params:{},data:{},done:function(e,t){layer.msg("更新成功")}},t.ysfetch(e,"com_update"),e.com_list={time:0,params:{},data:{}},t.ysfetch(e,"com_list"),e.com_list2={time:0,params:{},data:{}},t.ysfetch(e,"com_list2"),e.com_list3={time:0,params:{},data:{}},t.ysfetch(e,"com_list3"),e.com_list4={time:0,params:{},data:{}},t.ysfetch(e,"com_list4"),e.com_list5={time:0,params:{},data:{}},t.ysfetch(e,"com_list5"),e.com_list6={time:0,params:{},data:{}},t.ysfetch(e,"com_list6"),e.com_list_page={time:0,params:{},data:{}},t.ysfetch(e,"com_list_page"),e.com_list_page2={time:0,params:{},data:{}},t.ysfetch(e,"com_list_page2"),e.com_list_page3={time:0,params:{},data:{}},t.ysfetch(e,"com_list_page3"),e.com_detail={time:0,params:{},data:{}},t.ysfetch(e,"com_detail"),e.com_detail2={time:0,params:{},data:{}},t.ysfetch(e,"com_detail2"),e.com_detail3={time:0,params:{},data:{}},t.ysfetch(e,"com_detail3"),e.com_del={time:0,params:{},data:{}},t.ysfetch(e,"com_del"),e.com_del2={time:0,params:{},data:{}},t.ysfetch(e,"com_del2"),e.com_editadd={time:0,params:{},data:{}},t.ysfetch(e,"com_editadd"),e.com_editadd2={time:0,params:{},data:{}},t.ysfetch(e,"com_editadd2"),e.com_editadd3={time:0,params:{},data:{}},t.ysfetch(e,"com_editadd3"),e.com_editadd4={time:0,params:{},data:{}},t.ysfetch(e,"com_editadd4"),e.com_editadd5={time:0,params:{},data:{}},t.ysfetch(e,"com_editadd5");var i=location.href.split("#");url=i[1]||"/index",url.indexOf("?")>0&&(t.setstore("hash",t.hashtoobj(url.split("?")[1])),url=url.split("?")[0]);var n=url.split("/");n.shift();var o=n.join("_"),c=a[o];for(var d in c)if("init"==d)a[o][d](e);else{var r=o+"_"+d;e[r]=angular.copy(c[d]),t.ysfetch(e,r)}e.value={},e.tapshow=0,e.toggleshow=0,e.toggshow=0,e.editstatus=0,t.setstore("guanjian2",t.hashtoobj2(t.getstore("guanjian")));var s=t.getstore("guanjian2");if(s.codeid1){var l=t.getscope_byid(e,e.yscid);l.com_list.url="auth/diary_list1",l.com_list.params={codeid:t.getcd(l,"c5"),c_alias:"QS_diary",orderstrid:3},l.com_list.time=t.time(),l.toggleshow=1,UE.getEditor("editor"),setTimeout(function(){UE.getEditor("editor").destroy(),UE.getEditor("editor")},1),l.com_editadd4.params.content=s.content1,l.com_editadd4.params.codeid=s.codeid1,l.com_editadd4.params.diarystyle=parseInt(s.diarystyle1),l.com_editadd4.before=function(e){e.com_editadd4.params.content=UE.getEditor("editor").getContent()},l.com_editadd4.done=function(e,t){e.data&&(layer.msg("编辑成功"),setTimeout(function(){window.location.reload()},1e3))},t.setstore("guanjian",""),t.setstore("guanjian2","")}if(s.diarystyle2){var l=t.getscope_byid(e,e.yscid);l.com_list_page.params.diarystyle=parseInt(s.diarystyle2),t.setstore("guanjian",""),t.setstore("guanjian2","")}}]),app.directive("layerdateone",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=i.layerdateone.split(".");laydate.skin("yalan"),laydate({format:"YYYY-MM-DD",festival:!0,istime:!0,istoday:!0,choose:function(e){a[n[0]][n[1]][n[2]]=e}})})}}}]),app.directive("editstatus",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid);a.editstatus=i.editstatus,a.$apply()})}}}]),app.directive("lgout",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.ysmid);a.lgout.done=function(e,t){layer.msg("成功退出登录"),a.we="0"},a.lgout.time=e.time(),a.$apply(),setTimeout(function(){window.location.href="login.html"},1e3)})}}}]),app.directive("comdelone",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=i.comdelone,o=i.theid||"id",c=i.tip?i.tip:"您确定要删除么？",d=layer.confirm(c,{btn:["确定","取消"]},function(){a[n].params[o]=t.value[o],a[n].done=function(e){1==e.code?(t.value.isdel=1,layer.msg("删除成功")):layer.msg("删除失败"),layer.close(d)},a[n].time=e.time(),a.$apply()})})}}}]),app.directive("comaskrun",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=i.comaskrun,o=i.theid||"id",c=i.tip?i.tip:"您确定要提交么？",d=layer.confirm(c,{btn:["确定","取消"]},function(){a[n].params[o]=t.value[o],a[n].done=function(e){layer.msg(e.msg),layer.close(d)},a[n].time=e.time(),a.$apply()})})}}}]),app.directive("comdone",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=i.comdone.split("."),o=i.key||"id";a[n[0]][n[1]][o]=t.value[o],a[n[0]][n[1]][n[2]]=parseInt(i.v),t.value[n[2]]=parseInt(i.v),a[n[0]].time=e.time(),a.$apply()})}}}]),app.directive("comtime",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid);a[i.comtime].time=e.time(),a.$apply()})}}}]),app.directive("comedit",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){e.setstore("id",i.comedit)})}}}]),app.directive("ysselect",["fac",function(e){return{link:function(t,a,i,n){a.on("change",function(){var a=i.ysselect.split("."),n=e.getscope_byid(t,t.yscid);n[a[0]][a[1]][a[2]]=$(this).val(),n.$apply()})}}}]),app.directive("ysupdateone",["fac",function(e){return{link:function(t,a,i,n){a.on("change",function(){var a=e.getscope_byid(t,t.yscid),n=i.ysupdateone.split(".");a[n[0]][n[1]]=t.value,a[n[0]][n[1]][n[2]]=$(this).val(),a[n[0]].time=e.time(),a.$apply()})}}}]),app.directive("ysupdatetwo",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=i.ysupdatetwo.split("."),o=i.theid;a[n[0]][n[1]][o]=t.value[o],a[n[0]].time=e.time(),a.$apply()})}}}]),app.directive("selecttap",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=i.selecttap.split("."),n=e.getscope_byid(t,t.yscid);n[a[0]][a[1]][a[2]]=i.val,n.$apply()})}}}]),app.directive("setstore",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){e.setstore(i.key,i.setstore)})}}}]),app.directive("ysselectrun",["fac",function(e){return{link:function(t,a,i,n){a.on("change",function(){var a=i.ysselectrun.split("."),n=e.getscope_byid(t,t.yscid);n[a[0]][a[1]][a[2]]=$(this).val(),n[a[0]].time=e.time(),n.$apply()})}}}]),app.directive("ysselectall",["fac",function(e){return{link:function(t,a,i,n){a.on("change",function(){var n=i.ysselectall.split("."),o=e.getscope_byid(t,t.yscid),c=n[2]?o[n[0]][n[1]][n[2]]:o[n[0]][n[1]];c.map(function(e){e.chk=$(a).is(":checked")?1:0}),o.$apply()})}}}]),app.directive("ysselectone",["fac",function(e){return{link:function(e,t,a,i){t.on("click",function(){e.value.chk=1==e.value.chk?0:1,cscope.$apply()})}}}]),app.directive("yscheckrun",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var n=i.yscheckrun.split("."),o=e.getscope_byid(t,t.yscid),c=$(a).is(":checked");t.value[n[2]]=c?1:"0",o[n[0]][n[1]]=t.value,o[n[0]].time=e.time(),o.$apply()})}}}]),app.directive("ysupdaterun",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=i.ysupdaterun.split("."),n=e.getscope_byid(t,t.yscid);n[a[0]][a[1]][a[2]]=""==t.value[a[2]]?1:"",n[a[0]][a[1]][i.key]=t.value[i.key],t.value[a[2]]=""==t.value[a[2]]?1:"",n[a[0]].time=e.time(),n.$apply()})}}}]),app.directive("yseditadd",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid);a[i.yseditadd].params=t.value||a.value,a.$apply()})}}}]),app.directive("ysaddpid",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid);a[i.ysaddpid].params.pid=t.value.id,a.$apply()})}}}]),app.directive("tapshow",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid);a.tapshow=i.tapshow,a.$apply()})}}}]),app.directive("mainshow",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.ysmid);a.mainshow=i.mainshow,a.$apply()})}}}]),app.directive("mkshow",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=i.mkshow;1==a[n]?a[n]=0:a[n]=1,a.$apply()})}}}]),app.directive("mkshowrun",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=i.mk;a[n]=0,a[i.mkshowrun].time=e.time(),a.$apply()})}}}]),app.directive("toggleshow",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid);a.toggleshow=i.toggleshow,a.$apply()})}}}]),app.directive("toggleshowrun",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid);a.toggleshow=i.toggle,a[i.toggleshowrun].time=e.time(),a.$apply()})}}}]),app.directive("toggshow",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid);a.toggshow=i.toggshow,a.$apply()})}}}]),app.directive("toggshowrun",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid);a.toggshow=i.togg,a[i.toggshowrun].time=e.time(),a.$apply()})}}}]),app.directive("tapshowrun",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid);a.tapshow=i.tap,a[i.tapshowrun].time=e.time(),a.$apply()})}}}]),app.directive("ystaprun",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=i.ystaprun.split(".");a[n[0]][n[1]][n[2]]=t.value[n[2]],a.tapshow=i.tap,a[n[0]].time=e.time(),a.$apply()})}}}]),app.directive("ystaprun2",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid);a.mk1=0,a.mk3=0;var n=i.ystaprun2.split(".");a[n[0]][n[1]][n[2]]=i.value,a[n[0]][n[1]].keyword="",a.tapshow=i.tap,a[n[0]].time=e.time(),a.$apply()})}}}]),app.directive("selectrun",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=i.selectrun.split(".");a[n[0]][n[1]][n[2]]=i.value,a[n[0]].time=e.time(),a.$apply()})}}}]),app.directive("ysnoterun",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=i.ysnoterun.split(".");a[n[0]][n[1]][n[2]]=t.value.note,a.tapshow=i.tap,a[n[0]].time=e.time(),a.$apply()})}}}]),app.directive("tapshowupload",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid);a.tapshow=i.tapshowupload;var n=i.savekey.split(".");$list=$("#thelist"),$btn=$("#ctlBtn"),state="pending";var o=a[n[0]][n[1]],c=n[2];e.webupload($list,$btn,state,o,c,a,i.more),UE.getEditor("editor"),setTimeout(function(){UE.getEditor("editor").destroy(),UE.getEditor("editor")},500),a.$apply()})}}}]),app.directive("chushishu",["fac",function(e){return{link:function(e,t,a,i){t.on("click",function(){UE.getEditor("editor"),setTimeout(function(){UE.getEditor("editor").destroy(),UE.getEditor("editor")},1)})}}}]),app.directive("delimg",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=i.delimg.split("."),o=n[2]+"arr";a[n[0]][n[1]][o].splice(t.$index,1);var c=a[n[0]][n[1]][o].map(function(e){return e});a[n[0]][n[1]][n[2]]=c.join(","),a.$apply()})}}}]),app.directive("delimg2",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=i.delimg2.split("."),o=n[2],c="#"+i.key1,d="#"+i.key2;a[n[0]][n[1]][o]="",$(c).addClass("none"),$(d).addClass("none"),a.$apply()})}}}]),app.directive("delimg3",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=i.delimg3.split("."),o=n[2]+"arr";a[n[0]][n[1]][o].splice(t.$index,1);var c=a[n[0]][n[1]][o].map(function(e){return e});a[n[0]][n[1]][n[2]]=c.join(",");var d=i.delkey+"arr";a[n[0]][n[1]][d].splice(t.$index,1);var r=a[n[0]][n[1]][d].map(function(e){return e});a[n[0]][n[1]][i.delkey]=r.join(","),a.$apply()})}}}]),app.directive("tapshowupload2",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid);a.tapshow=i.tapshowupload2,a.$apply();var n=i.savekey.split(".");$list=$("#thelist"),$btn=$("#ctlBtn"),state="pending";var o=a[n[0]][n[1]],c=n[2];e.webupload($list,$btn,state,o,c,a,i.more)})}}}]),app.directive("tapshowupload3",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid);a.tapshow=i.tapshowupload3,a.$apply();var n=i.savekey.split(".");$list=$("#thelist"),$btn=$("#ctlBtn"),state="pending";var o=a[n[0]][n[1]],c=1,d=1;e.webupload($list,$btn,state,o,c,a,d)})}}}]),app.directive("mkshowupload",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid);a.mk2=i.mkshowupload,a.$apply();var n=i.savekey.split(".");$list=$("#thelist"),$btn=$("#ctlBtn"),state="pending";var o=a[n[0]][n[1]],c=n[2];e.webupload($list,$btn,state,o,c,a,i.more)})}}}]),app.directive("toggshowupload",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid);a.toggshow=i.toggshowupload,a.$apply();var n=i.savekey.split(".");$list=$("#thelist"),$btn=$("#ctlBtn"),state="pending";var o=a[n[0]][n[1]],c=1,d=1;e.webupload($list,$btn,state,o,c,a,d)})}}}]),app.directive("pickerrun",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var t=e.getstore("upimg");e.setstore("hash",e.hashtoobj(t))})}}}]),app.directive("updatepage",["fac",function(e){return{link:function(t,a,i,n){a.on("change",function(n){var o=e.getscope_byid(t,t.yscid),c=i.updatepage.split("."),d=i.key;o[c[0]][c[1]][d]=t.value[d],o[c[0]][c[1]][c[2]]=$(a).val(),t.value[c[2]]=$(a).val(),o[c[0]].time=e.time(),o.$apply()})}}}]),app.directive("updateshenhe",["fac",function(e){return{link:function(t,a,i,n){a.on("change",function(n){var o=e.getscope_byid(t,t.yscid),c=i.updateshenhe.split("."),d=i.key,r=i.reason||"reason";o[c[0]][c[1]][d]=t.value[d],"2"==$(a).val()?layer.prompt({title:"审核不通过原因",formType:2},function(i,n){""===i?layer.msg("原因不能为空"):(layer.close(n),o[c[0]][c[1]][c[2]]=$(a).val(),o[c[0]][c[1]][r]=i,t.value[c[2]]=$(a).val(),o[c[0]].time=e.time(),o.$apply())}):(o[c[0]][c[1]][c[2]]=$(a).val(),t.value[c[2]]=$(a).val(),o[c[0]].time=e.time(),o.$apply())})}}}]),app.directive("updaterun",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=i.updaterun.split(".");i.key;a[n[0]][n[1]][n[2]]=i.value,t.value[n[2]]=i.value,a[n[0]].time=e.time(),a.$apply()})}}}]),app.directive("optionrun",["fac",function(e){return{link:function(t,a,i,n){a.on("mouseover",function(){var a=e.getscope_byid(t,t.yscid),n=i.optionrun.split(".");i.key;a[n[0]][n[1]][n[2]]=i.value,t.value[n[2]]=i.value,a[n[0]].time=e.time(),a.$apply()})}}}]),app.directive("changeimg",["fac",function(e){return{link:function(t,a,i,n){a.on("change",function(){var a=(e.getscope_byid(t,t.yscid),e.getObjectURL(this.files[0]));a&&$(".basicinfortimg").find("img").attr("src",a)})}}}]),app.directive("imgupload",["fac",function(e){return{link:function(t,a,i,n){a.on("change",function(){var a=e.getscope_byid(t,t.yscid),n=i.imgupload.split(".");$(i.formid).ajaxSubmit({success:function(e){a[n[0]][n[1]][n[2]]=e.data.pathurl,a.$apply()}})})}}}]),app.directive("pimgupload",["fac",function(e){return{link:function(t,a,i,n){a.on("change",function(){var a=e.getscope_byid(t,t.yscid);$(document).on("change",".a-upload",function(){var t=$(this).val();if(t.indexOf("jpg")==-1&&t.indexOf("png")==-1)return layer.msg('请上传"jpg"或者"png"格式的文件'),!1;var n=i.pimgupload.split(".");$(i.formid).ajaxSubmit({url:"http://newtemp.yushan.com/index.php/auth/formupload?token="+e.getstore("ystoken"),success:function(e){a[n[0]][n[1]][n[2]]=e.data.pathurl,a.$apply(),a.$apply()}})})})}}}]),app.directive("fileupload",["fac",function(e){return{link:function(t,a,i,n){a.on("change",function(){alert(123);var a=e.getscope_byid(t,t.yscid),n=i.fileupload.split(".");$(i.formid).ajaxSubmit({success:function(e){a[n[0]][n[1]][n[2]]=e.data.pathurl,a.$apply()}})})}}}]),app.directive("resumeupload",["fac",function(e){return{link:function(t,a,i,n){a.on("change",function(){var a=e.getscope_byid(t,t.yscid);$(document).on("change",".a-upload",function(){var t=$(this).val();if(t.indexOf("jpg")==-1&&t.indexOf("pdf")==-1&&t.indexOf("doc")==-1&&t.indexOf("docx")==-1)return layer.msg("您上传文件类型有误！请重新上传"),!1;var n=i.resumeupload.split(".");$(i.formid).ajaxSubmit({url:"http://newtemp.yushan.com/index.php/auth/resumeupload?token="+e.getstore("ystoken"),success:function(t){a[n[0]][n[1]][n[2]]=t.data.pathurl,a[n[0]][n[1]].attachmentname=t.data.filename,a.com_list2.data.attachmentname=t.filename,a.com_list2.time=e.time,a.$apply()}})})})}}}]),app.directive("chkpowitem",["fac",function(e){return{link:function(e,t,a,i){t.on("click",function(){var e=$(t).is(":checked");$(t).parent().parent().parent().find("input").prop("checked",e)})}}}]),app.directive("yschatrun",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid);a[i.yschatrun].params.touserid=i.touserid,a[i.yschatrun].time=e.time(),a.$apply()})}}}]),app.directive("yssendmsg",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=$.trim($("#editor").val()),o=i.chattype;if(""==n&&1==o)return layer.tips("请输入内容","#send"),!1;var c={nickname:user1.nickname,
uid:user1.id,content:n,filetype:0,chattype:o,avatar:user1.avatar,jobid:user1.jobid,note:user1.note,reason:user1.reason},d={nickname:user2.nickname,uid:user2.id,type:"privateChat",chattype:o,avatar:user2.avatar},r=e.setMessage("chatMessage",c,d);a.socket.send(r),$("#editor").val(""),$("#editor").focus()})}}}]),app.directive("closeface",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){e.getscope_byid(t,t.yscid);$("#facebox").hide()})}}}]),app.directive("clickface",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){e.getscope_byid(t,t.yscid);$("#facebox").show()})}}}]),app.directive("clickinput",["fac",function(e){return{link:function(t,a,i,n){a.on("focus",function(){e.getscope_byid(t,t.yscid);url="#"+i.id,$(url).attr("placeholder","")})}}}]),app.directive("moveinput",["fac",function(e){return{link:function(t,a,i,n){a.on("blur",function(){var a=(e.getscope_byid(t,t.yscid),i.placeholder);url="#"+i.id,$(url).attr("placeholder",a)})}}}]),app.directive("ysadd",["fac",function(e){return{link:function(t,a,i,n){t.nadd=0,a.on("click",function(){var a=e.getscope_byid(t,t.yscid);a[i.ysadd].params={},a[i.ysadd].type=i.type,a[i.ysadd].params.type=i.type,a.$apply()})}}}]),app.directive("getcity",["fac",function(e){return{link:function(t,a,i,n){a.on("mouseover",function(){var a=e.getscope_byid(t,t.yscid);a.nowcity=[],a.com_list2.data.map(function(e){e.pid==i.getcity&&a.nowcity.push(e)}),t.$apply()})}}}]),app.directive("getjobtype",["fac",function(e){return{link:function(t,a,i,n){a.on("mouseover",function(){var a=e.getscope_byid(t,t.yscid);a.thejob=[],a.com_list.data.map(function(e){e.pid==i.getjobtype&&a.thejob.push(e)}),t.$apply()})}}}]),app.directive("getjobname",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=i.val;a.com_list.data.map(function(e){e.id==n&&(a.com_editadd.params.trade_cn=e.categoryname,$(".resume-job-type").find("ul").css("display","none"))}),t.$apply()})}}}]),app.directive("getkw",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=(e.getscope_byid(t,t.yscid),t.keyword),n=window.location.href.split("?"),o=e.getstore("hash"),c=i.getkw,d=c+"="+a;if(o){var r=[],s=!1;for(key in o){var l=key+"="+o[key];key==c&&(s=!0,l=key+"="+a),r.push(l)}s||r.push(d);var u=r.join("&");window.location.href=n[0]+"?"+u}else d=n[0]+"?"+d,window.location.href=d;t.$apply()})}}}]),app.directive("setlocalurl",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=i.setlocalurl,o=t.keyword;a.com_list5.params.cid=t.value.c_id;var c=i.val,d=n+"="+c,r=e.getstore("hash"),s=window.location.href.split("?");if(""==r)d=s[0]+"?"+d,window.location.href=d;else if(""==o){delete r.keyword;var l=[],u=!1;for(key in r){var p=key+"="+r[key];key==n&&(u=!0,p=key+"="+c),l.push(p)}u||l.push(d);var m=l.join("&");window.location.href=s[0]+"?"+m}else{var l=[],u=!1;for(key in r){var p=key+"="+r[key];key==n&&(u=!0,p=key+"="+c),l.push(p)}u||l.push(d);var m=l.join("&");window.location.href=s[0]+"?"+m}t.$apply()})}}}]),app.directive("setcyprurl",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=i.setcyprurl,o=i.val,c=(e.getstore("hash"),t.keyword),d=window.location.href.split("?");a.com_list2.data.map(function(e){var t="";o==e.cityid&&(t=e.pid,c?window.location.href=d[0]+"?"+n+"="+o+"&province="+t+"&keyword="+c:window.location.href=d[0]+"?"+n+"="+o+"&province="+t)}),t.$apply()})}}}]),app.directive("setprovrurl",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.yscid),n=i.setprovrurl,o=i.val,c=(e.getstore("hash"),t.keyword),d=window.location.href.split("?"),r=[],s=[];a.com_list2.data.map(function(e){if(o==e.pid){r.push(e.city),s.push(e.cityid),a.cityname=r[0];var t=s[0];c?window.location.href=d[0]+"?"+n+"="+o+"&city="+t+"&keyword="+c:window.location.href=d[0]+"?"+n+"="+o+"&city="+t}}),t.$apply()})}}}]),app.directive("delpro",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=(e.getscope_byid(t,t.yscid),e.getstore("hash")),n=window.location.href.split("?"),o=i.delpro;if(null!=a&&void 0!=a[o]){delete a[o],delete a.city,e.setstore("hash",a);var c=[];for(o in a){var d=o+"="+a[o];c.push(d)}var r=c.join("&");window.location.href=n[0]+"?"+r}t.$apply()})}}}]),app.directive("delthis",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=(e.getscope_byid(t,t.yscid),e.getstore("hash")),n=window.location.href.split("?"),o=i.delthis;if(null!=a&&void 0!=a[o]){delete a[o],e.setstore("hash",a);var c=[];for(o in a){var d=o+"="+a[o];c.push(d)}var r=c.join("&");window.location.href=n[0]+"?"+r}t.$apply()})}}}]),app.directive("findpsword",["fac",function(e){return{link:function(e,t,a,i){t.on("click",function(){setTimeout(function(){layer.open({type:1,title:!1,closeBtn:!1,shade:.8,id:"LAY_layuipro",resize:!1,btnAlign:"c",area:["434px","402px"],moveType:1,shade:!1,content:$(".forget-box")})},300),e.$apply()})}}}]),app.directive("rightornot",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=t.username,i=t.captcha,n=t.code,o=t.passwordone,c=t.passwordtwo,d=e.testphone(a);if(void 0==a)layer.msg("请输入手机号码");else if(d)if(i)if(n)if(o&&c)if(o.length<6||16<o.length||c.length<6||16<c.length)layer.msg("请输入6-16位密码");else if(o!==c)layer.msg("输入两次密码不一致");else{var r={username:a,password:o,code:n};$.ajax({url:"http://newtemp.yushan.com/index.php/base/find_pass",type:"POST",xhrFields:{withCredentials:!0},data:r,success:function(e){1==e.code?(layer.msg("修改成功,正在跳转"),setTimeout(function(){layer.closeAll()},1500)):layer.msg(e.msg),$("#captchahit").attr("src","http://newtemp.yushan.com/index.php/Base/verify?timestamp="+Date.parse(new Date))}})}else layer.msg("密码不能为空");else layer.msg("请输入手机验证码");else layer.msg("请输入验证码");else layer.msg("请输入正确的手机号码");t.$apply()})}}}]),app.directive("registerbox",["fac",function(e){return{link:function(e,t,a,i){t.on("click",function(){layer.closeAll(),setTimeout(function(){layer.open({type:1,title:!1,closeBtn:!1,shade:.8,id:"LAY_layuipro",resize:!1,btnAlign:"c",area:["736px","408px"],moveType:1,shade:!1,content:$(".register-box")})},200)})}}}]),app.directive("zcscuuess",["fac",function(e){return{link:function(e,t,a,i){t.on("click",function(){layer.open({type:1,title:!1,closeBtn:!1,shade:.8,id:"LAY_layuipro",resize:!1,btnAlign:"c",area:["435px","150px"],moveType:1,shade:!1,content:$(".zc-scuuess"),success:function(e){window.setTimeout(" window.location.reload(); ",3e3)}})})}}}]),app.directive("enroll",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.ysmid),i=t.username,n=t.password,o=t.code,c=t.captcha,d=t.xycheckbox,r={username:i,password:n,captcha:c,code:o},s=e.testphone(i);void 0==i?layer.msg("请输入手机号码"):s?void 0==c?layer.msg("请输入验证码"):void 0==o?layer.msg("请输入短信验证码"):void 0==n||n.length<6||n.length>16?layer.msg("请输入6-16位密码"):d!==!0?layer.msg("您还没阅读《宇杉协议》"):$.ajax({url:"http://newtemp.yushan.com/index.php/base/u_register",type:"POST",xhrFields:{withCredentials:!0},data:r,success:function(e){1==e.code?(layer.msg("注册成功,正在跳转"),localStorage.setItem("ystoken",e.token),localStorage.setItem("uuid",e.uuid),setTimeout(function(){layer.closeAll(),a.we=1,a.$apply()},1500)):(layer.msg("该用户已注册,请您直接登录"),setTimeout(function(){layer.closeAll()},800),setTimeout(function(){layer.open({type:1,title:!1,closeBtn:!1,shade:.8,id:"LAY_layuipro",resize:!1,btnAlign:"c",area:["738px","364px"],moveType:1,shade:!1,content:$(".login-box")})},1500)),$("#captchahit").attr("src","http://newtemp.yushan.com/index.php/Base/verify?timestamp="+Date.parse(new Date))}}):layer.msg("请输入正确的手机号码")})}}}]),app.directive("checkcode",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=t.captcha,n=(i.value,t.username),o={username:n,check:1,captcha:a},c=e.testphone(n);void 0==n?layer.msg("请输入手机号码"):c?a?$.ajax({url:"http://newtemp.yushan.com/index.php/base/getphoneverifycode",type:"POST",xhrFields:{withCredentials:!0},data:o,success:function(e){if(1==e.code){layer.msg("验证码已发送");var t=59;$(".ipt").val("发送验证码");var a=setInterval(function(){t>1?($(".ipt").addClass("color_8f"),$(".ipt").attr("disabled",!0),t=~~t-1,$(".ipt").val("重新发送("+t+")")):($(".ipt").val("发送验证码"),clearInterval(a),$(".ipt").addClass("color_blue"),$(".ipt").attr("disabled",!1))},1e3)}else layer.msg(e.msg)}}):layer.msg("请输入验证码"):layer.msg("请输入正确的手机号码")})}}}]),app.directive("downpage",["fac",function(e){return{link:function(e,t,a,i){t.on("click",function(){window.open(a.downpage)})}}}]),app.directive("refresh",["fac",function(e){return{link:function(e,t,a,i){t.on("click",function(){window.location.reload()})}}}]),app.directive("loginbox",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){null==window.lg?e.lginbox():""})}}}]),app.directive("lgnull",["fac",function(e){return{link:function(e,t,a,i){t.on("click",function(){window.lg=null})}}}]),app.directive("loginbt",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.ysmid),i=$("#username").val(),n=$("#password").val(),o=$("#captcha").val(),c={username:i,password:n,captcha:o};$.ajax({url:"http://newtemp.yushan.com/index.php/Base/login",type:"POST",xhrFields:{withCredentials:!0},data:c,success:function(e){1==e.code?(layer.msg("系统登录中…"),localStorage.setItem("ystoken",e.token),localStorage.setItem("uuid",e.uuid),a.we=1,a.$apply(),setTimeout(function(){layer.closeAll()},1e3)):$("#tip").html(e.msg),$("#captchahit").attr("src","http://newtemp.yushan.com/index.php/Base/verify?timestamp="+Date.parse(new Date))}})})}}}]),app.directive("loginphbt",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=e.getscope_byid(t,t.ysmid),i=t.username,n=t.code,o={username:i,code:n},c=e.testphone(i);c?void 0==n?layer.msg("请输入验证码"):$.ajax({url:"http://newtemp.yushan.com/index.php/base/phone_login",type:"POST",xhrFields:{withCredentials:!0},data:o,success:function(e){1==e.code?(layer.msg("系统登录中…"),localStorage.setItem("ystoken",e.token),localStorage.setItem("uuid",e.uuid),setTimeout(function(){layer.closeAll(),a.we=1,a.$apply()},1e3)):layer.msg(e.msg),$("#captchahit").attr("src","http://newtemp.yushan.com/index.php/Base/verify?timestamp="+Date.parse(new Date))}}):layer.msg("请输入正确的手机号码")})}}}]),app.directive("loginckcode",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){var a=t.code,n=(i.value,t.username),o={username:n,code:a},c=e.testphone(n);if(c){var d=59;$(this).val("发送验证码");var r=this,s=setInterval(function(){d>1?($(r).addClass("color_8f"),$(r).attr("disabled",!0),d=~~d-1,$(r).val("重新发送("+d+")")):($(r).val("发送验证码"),clearInterval(s),$(r).addClass("color_blue"),$(r).attr("disabled",!1))},1e3);$.ajax({url:"http://newtemp.yushan.com/index.php/base/getphoneverifycode",type:"POST",xhrFields:{withCredentials:!0},data:o,success:function(e){1==e.code?layer.msg("验证码已发送"):layer.msg("验证码发送失败")}})}else layer.msg("请输入正确的手机号码")})}}}]),app.factory("hdl",["fac",function(e){var t={index:{init:function(t){$(document).ready(function(){setTimeout(function(){new Swiper(".swiper-container",{pagination:".swiper-pagination",paginationClickable:!0,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",autoHeight:!0})},1500)}),t.com_list.params.codeid=e.getcd(t,"c1"),t.com_list.params.diarytype=1,t.com_list.params.top=3,t.com_list.params.orderstrid=2,t.com_list.time=e.time(),t.com_list.done=function(e,t){for(var a=e.data.length-1;a>=0;a--)e.data[a].content.length>12&&(e.data[a].content=e.data[a].content.substr(0,12)+"...")},t.com_list2.params.codeid=e.getcd(t,"c1"),t.com_list2.params.diarytype=2,t.com_list2.params.top=3,t.com_list2.params.orderstrid=2,t.com_list2.time=e.time(),t.com_list2.done=function(e,t){for(var a=e.data.length-1;a>=0;a--)e.data[a].content.length>12&&(e.data[a].content=e.data[a].content.substr(0,12)+"...")},t.com_list3.params.codeid=e.getcd(t,"c1"),t.com_list3.params.diarytype=3,t.com_list3.params.top=3,t.com_list3.params.orderstrid=2,t.com_list3.time=e.time(),t.com_list3.done=function(e,t){for(var a=e.data.length-1;a>=0;a--)e.data[a].content.length>12&&(e.data[a].content=e.data[a].content.substr(0,12)+"...")},t.com_list4.url="auth/com_list",t.com_list4.params={codeid:e.getcd(t,"c5"),c_alias:"QS_diary",orderstrid:3},t.com_list4.time=e.time(),t.com_list4.done=function(e,t){var a=0,i=0;t.tArray=new Array,t.tArray[i]=[];for(var n=0;n<e.data.length;n++)t.tArray[i].push(e.data[n]),a+=1,6==a&&e.data.length!=n+1&&(a=0,i+=1,t.tArray[i]=[])},t.com_detail.url="auth/beijing_detail",t.com_detail.params.codeid=e.getcd(t,"c1"),t.com_detail.time=e.time()}},edit:{init:function(t){t.com_detail.url="auth/self_info",t.com_detail.time=e.time(),t.com_editadd.url="base/editper",t.com_editadd.done=function(t,a){e.dogoto(t,"#edit")}}},profile:{init:function(t){t.com_detail.url="auth/self_info",t.com_detail.time=e.time(),t.com_detail.done=function(t,a){a.com_editadd.params=t.data,a.com_editadd.url="auth/self_info_update",a.com_editadd.before=function(e){e.com_editadd.params.city=$("#city").attr("pname")+$("#city").attr("cname")},a.com_editadd.done=function(t,a){e.dogoto(t,"#profile")}}}},contacts:{init:function(t){$(document).on("mouseover",".enlarge",function(){$(".contact-box").each(function(){animationHover($(this),"pulse")})}),t.com_list.url="auth/mycom_list",t.com_list.params.codeid=e.getcd(t,"c7"),t.com_list.time=e.time(),t.com_list.done=function(e,t){},t.com_editadd.url="auth/mycom_editadd",t.com_editadd.before=function(t){void 0==t.com_editadd.params.codeid&&(t.com_editadd.params.codeid=e.getcd(t,"c7")),t.com_editadd.params.city=$("#city").attr("pname")+$("#city").attr("cname")},t.com_editadd.done=function(t,a){e.dogoto(t,"#contacts")}}},diary:{init:function(t){t.mk1=0,t.mk2=0,t.mk3=0,t.mk4=0;var a=[];$(document).on("click",".diaryul li",function(){a=[]}),$(document).on("click","[name='incode2']",function(){var e=$(this).parent().parent().index(),t=$("[name='incode']").eq(e).find("input").is(":checked");if(t)a.push($(this).val());else for(var i=0;i<a.length;i++)$(this).val()==a[i]&&a.splice(e-1,1)}),$(document).on("click","#ckeckAll",function(){for(var e=0,t=0;t<$("[name='incode']").length;t++)$("[name='incode']").eq(t).find("input").is(":checked")&&(e+=1);if(e==$("[name='incode']").length)$("[name='incode']").find("input").prop("checked",!1),a=[];else{$("[name='incode']").find("input").prop("checked",!0),$("#ckeckAll").prop("checked",!0);for(var i=0;i<$("[name='incode']").length;i++)a.push($("[name='incode']").eq(i).find("input").val())}}),t.com_del2.before=function(e){var t=a.join(",");e.com_del2.params.codeid=t},t.com_del2.done=function(t,i){a=[],1==t.code&&e.dogoto(t,"#diary")},$(document).on("click","#order-by-sel",function(){$("#order-by-sel").toggleClass("select_order"),$("#order-by-sel").toggleClass("bor2"),$("#order-by-mnu").toggle()}),$(document).on("blur","#order-by-sel",function(){setTimeout(function(){$("#order-by-sel").removeClass("select_order"),$("#order-by-sel").removeClass("bor2"),$("#order-by-mnu").hide()},200)}),$(document).on("click","#order-by-mnuul li",function(){var e=$(this).text();$("#order-by-sel").find("span").eq(0).text(e);var t=$(this).index();$("#order-by-mnuul li").find("a").removeClass("none"),$("#order-by-mnuul li").eq(t).find("a").addClass("none")}),$(document).on("focus","#blog_search_text",function(){$(".mod_search").removeClass("bor2"),$(".mod_search").removeClass("bg"),$("#blog_search_text").removeClass("c_tx3"),$(".mod_search").addClass("mt_5"),$(".mod_search").addClass("mlmb_11"),$(".mod_search").addClass("textinput_focus")}),$(document).on("blur","#blog_search_text",function(){$(".mod_search").addClass("bor2"),$(".mod_search").addClass("bg"),$("#blog_search_text").addClass("c_tx3"),$(".mod_search").removeClass("mt_5"),$(".mod_search").removeClass("mlmb_11"),$(".mod_search").removeClass("textinput_focus")}),$(document).on("click","[name='d']",function(){layer.open({type:1,title:"添加日志分类",area:["380px","147px"],offset:"c",content:'<div class="add_sort"><span>分类名称：</span><input type="text" placeholder="请输入分类"><span>（最多12个字母或6个汉字）</span></div>',btn:["确定","取消"],btnAlign:"t",yes:function(){t.com_editadd2.params.c_name=$(".layui-layer-content").find("input").val(),t.com_editadd2.time=e.time(),t.$apply(),layer.closeAll()}})}),$(document).on("click","[name='e']",function(){var e=$(this).parent().parent().parent().parent().index();$("[name='incode']").eq(e).children(".layui-layer2").show(),$("[name='incode']").eq(e).children(".qz_mask2").show()}),$(document).on("click","[name='close1']",function(){$(this).parent().parent().hide(),$(this).parent().parent().next().hide()}),$(document).on("click",".modify_type",function(){$(".mod_modify_type").toggle()}),$(document).on("blur",".modify_type",function(){setTimeout(function(){$(".mod_modify_type").hide()},200)}),$(document).on("click",".arr_wrap",function(){var e=$(this).parent().parent().parent().index(),t=$("#listAreaul").children("li").eq(e).find(".list_op").hasClass("show_more_op");$("#listAreaul").children("li").find(".list_op").removeClass("show_more_op"),t?$("#listAreaul").children("li").eq(e).find(".list_op").removeClass("show_more_op"):$("#listAreaul").children("li").eq(e).find(".list_op").addClass("show_more_op");var a=$("#listAreaul").children("li").eq(e).find(".mod_drop_op").css("display");$("#listAreaul").children("li").find(".mod_drop_op").hide(),"none"==a?$("#listAreaul").children("li").eq(e).find(".mod_drop_op").show():$("#listAreaul").children("li").eq(e).find(".mod_drop_op").hide();var i=$("#listAreaul").children("li").eq(e).find(".arr_wrap").hasClass("bg");$("#listAreaul").children("li").find(".arr_wrap").removeClass("bg"),$("#listAreaul").children("li").find(".arr_wrap").removeClass("bor2"),i?($(this).removeClass("bg"),$(this).removeClass("bor2")):($(this).addClass("bg"),$(this).addClass("bor2"))}),$(document).on("blur",".arr_wrap",function(){var e=$(this).parent().parent().parent().index();setTimeout(function(){$("#listAreaul").children("li").eq(e).find(".list_op").removeClass("show_more_op"),$("#listAreaul").children("li").eq(e).find(".mod_drop_op").hide(),$("#listAreaul").children("li").eq(e).find(".arr_wrap").removeClass("bg"),$("#listAreaul").children("li").eq(e).find(".arr_wrap").removeClass("bor2")},200)}),$(document).on("click","[name='fenlei1']",function(){var e=$(this).parent().parent().index();$("#cateMgrDiv").children("li").find(".admin_normal").show(),$("#cateMgrDiv").children("li").find(".admin_edit").hide(),$("#cateMgrDiv").children("li").eq(e).find(".admin_normal").hide(),$("#cateMgrDiv").children("li").eq(e).find(".admin_edit").show()}),$(document).on("click","[name='fenlei2']",function(){var e=$(this).parent().parent().index();$("#cateMgrDiv").children("li").eq(e).find(".admin_normal").show(),$("#cateMgrDiv").children("li").eq(e).find(".admin_edit").hide()}),$(document).on("click","[name='fenlei3']",function(){$("#cateMgrDiv").children("li").last().find("input").val("")}),$(document).on("click","#cateList li",function(){t.com_list_page.params.keyword="",t.com_list_page.params.begintime="",t.com_list_page.params.endtime="",t.com_list_page.params.diarystyle=e.getstore("c_id"),t.com_list_page.time=e.time(),t.$apply()}),$(document).on("click","#blog_search_btn",function(){t.mk3=0,t.com_list_page.params.diarystyle="",t.com_list_page.time=e.time(),t.$apply(),$("#cateList").children("li").removeClass("bg3_hover2"),$("#cateList").children("li").eq(0).addClass("bg3_hover2")}),$(document).on("click",".diarybutton",function(){t.mk3=0,t.com_list_page.time=e.time(),t.$apply()}),t.com_list_page.url="auth/mycom_list_page",t.com_list_page.params.codeid=e.getcd(t,"c1"),t.com_list_page.params.listnum=15,t.com_list_page.params.diarytype=1,t.com_list_page.params.format=1,t.com_list_page.params.orderstrid=2,t.com_list_page.time=e.time(),t.com_list_page.before=function(e){$("#jiansuo1").val()||(e.com_list_page.params.begintime=""),$("#jiansuo2").val()||(e.com_list_page.params.endtime="")},t.com_list_page.done=function(t,a){a.total=t.code,a.com_list.url="auth/diary_list1",a.com_list.params={codeid:e.getcd(a,"c5"),c_alias:"QS_diary",orderstrid:3,diarytype:a.com_list_page.params.diarytype},a.com_list.time=e.time(),a.com_list.done=function(e,t){t.diarytotal=e.arr.total,t.com_list_page.params.diarystyle?setTimeout(function(){var e=parseInt(t.com_list_page.params.diarystyle);$("#cateList").children("li").removeClass("bg3_hover2"),$("#cateList").children("li").eq(e).addClass("bg3_hover2")},1):($("#cateList").children("li").removeClass("bg3_hover2"),$("#cateList").children("li").eq(0).addClass("bg3_hover2"))},a.com_editadd4.params.format=1,a.com_editadd4.params.diarytype=a.com_list_page.params.diarytype,a.com_editadd4.url="auth/mycom_editadd",a.com_editadd4.before=function(t){void 0==t.com_editadd4.params.codeid&&(t.com_editadd4.params.codeid=e.getcd(t,"c1")),t.com_editadd4.params.content=UE.getEditor("editor").getContent()},a.com_editadd4.done=function(t,a){1==t.code&&e.dogoto(t,"#diary")}},t.com_editadd.params.c_alias="QS_diary",t.com_editadd.before=function(e){if(e.com_editadd.params.c_name.length>12)return layer.msg("请调整类别名称长度"),!1},t.com_editadd.done=function(e,t){1==e.code&&($("#cateMgrDiv").children("li").find(".admin_normal").show(),$("#cateMgrDiv").children("li").find(".admin_edit").hide())},t.com_editadd2.params.c_alias="QS_diary",t.com_editadd2.before=function(t){if(void 0==t.com_editadd2.params.codeid&&(t.com_editadd2.params.codeid=e.getcd(t,"c5")),t.com_editadd2.params.c_name.length>12)return layer.msg("请调整类别名称长度"),!1},t.com_editadd2.done=function(e,t){1==e.code&&(t.com_list.data.push(e.data),t.mk4=0,t.$apply())},t.com_editadd3.url="auth/diary_editadd",t.com_editadd3.before=function(e){var t=a.join(",");e.com_editadd3.params.codeid=t},t.com_editadd3.done=function(t,i){a=[],e.dogoto(t,"#diary")},t.com_editadd5.url="auth/diary_editadd",t.com_editadd5.done=function(t,a){e.dogoto(t,"#diary")}}},album:{init:function(t){t.mk1=0,t.mk2=0,t.mk3=0,t.mk4=0,$(document).ready(function(){$(".file-box").each(function(){animationHover(this,"pulse")})}),$(document).on("click",".deleteimg",function(){0==t.com_editadd.params.imgarr.length&&($(".statusBar").addClass("none"),$("#dndArea").removeClass("none"),$("#filePicker").addClass("none"))}),$(document).on("click",".layui-layer-setwin",function(){t.com_editadd.params.imgarr=[],t.mk2=0,t.$apply()}),$(document).on("click","[name='a']",function(){layer.open({type:1,title:"添加日志分类",area:["380px","147px"],offset:"c",content:'<div class="add_sort"><span>分类名称：</span><input type="text" placeholder="请输入分类"><span>（最多12个字母或6个汉字）</span></div>',btn:["确定","取消"],btnAlign:"t",yes:function(){t.com_editadd3.params.name=$(".layui-layer-content").find("input").val(),t.com_editadd3.url="auth/mycom_editadd",t.com_editadd3.params.codeid=e.getcd(t,"c9"),t.com_editadd3.time=e.time();var a=Array();t.com_editadd3.done=function(e,t){1==e.code&&(a.id=parseInt(e.data),a.name=t.com_editadd3.params.name,t.com_list.data.push(a))},t.$apply(),layer.closeAll()}})}),t.com_list.url="auth/album_list1",t.com_list.params={codeid:e.getcd(t,"c9"),orderstrid:3},t.com_list.time=e.time(),t.com_list.done=function(t,a){if(1==t.code){for(var i=t.data.length-1;i>=0;i--)t.data[i].name.length>10&&(t.data[i].name=t.data[i].name.substr(0,10)+"...");a.com_list2.url="auth/mycom_list",a.com_list2.params.codeid=e.getcd(a,"c8"),a.com_list2.params.pid=t.data[0].id,a.com_list2.params.orderstrid=2,a.com_list2.time=e.time(),a.com_list2.done=function(t,a){for(var i=0;i<a.com_list.data.length;i++)a.com_list.data[i].id==parseInt(a.com_list2.params.pid)&&($("#cateList").children("li").removeClass("bg3_hover2"),$("#cateList").children("li").eq(i+1).addClass("bg3_hover2"));a.com_editadd2.url="auth/album_editadd",a.com_editadd2.params.pid=a.com_list2.params.pid,a.com_editadd2.done=function(t,a){1==t.code&&e.dogoto(t,"#album")}}}},t.com_detail.done=function(e,t){1==e.code&&(t.mk4=1)},t.com_editadd.url="auth/mycom_editadd",t.com_editadd.params.codeid=e.getcd(t,"c9"),t.com_editadd.done=function(t,a){1==t.code&&e.dogoto(t,"#album")}}},video:{init:function(t){t.mk1=0,$(document).on("mouseover",".enlarge",function(){$(".contact-box2").each(function(){animationHover($(this),"pulse")})}),$(document).on("click",".videoul li",function(){t.com_editadd.params.content="",t.com_editadd.params.title="",t.com_editadd.params.thumb="",$("#fileList1").addClass("none"),$("#fileList2").addClass("none"),$("#imgparams1").addClass("none"),$("#imgparams2").addClass("none")}),t.com_list.url="auth/mycom_list",t.com_list.params.codeid=e.getcd(t,"c1"),t.com_list.params.format=3,t.com_list.time=e.time(),t.com_detail.done=function(e,t){1==e.code&&(t.mk1=1)},t.com_editadd.url="auth/mycom_editadd",t.com_editadd.before=function(t){void 0==t.com_editadd.params.codeid&&(t.com_editadd.params.codeid=e.getcd(t,"c1")),t.com_editadd.params.format=3},t.com_editadd.done=function(t,a){e.dogoto(t,"#video")}}},games:{init:function(t){$(document).on("click","#cateList li",function(){var t=$(this).index();e.setstore("game",t),window.location.reload()}),$(document).ready(function(){var t=e.getstore("game");e.setstore("game",""),$("#cateList").children("li").removeClass("bg3_hover2"),$("#cateList").children("li").eq(t).addClass("bg3_hover2"),$("[name='game']").addClass("none"),$("[name='game']").eq(t).removeClass("none"),setTimeout(function(){0!=t&&""!=$.trim(t)||(prepareForMobile(),newgame()),1==t&&(_bgExtName="png",_UniTypeNumber=6,$("#btnReset").bind("click",function(){location.reload()}),$("#btnReset2").bind("click",function(){location.reload()}),gameStart())},100)}),$(document).keydown(function(e){switch(e.preventDefault(),e.keyCode){case 37:moveLeft()&&(setTimeout("generateOneNumber()",210),setTimeout("isgameover()",300));break;case 38:moveUp()&&(setTimeout("generateOneNumber()",210),setTimeout("isgameover()",300));break;case 39:moveRight()&&(setTimeout("generateOneNumber()",210),setTimeout("isgameover()",300));break;case 40:moveDown()&&(setTimeout("generateOneNumber()",210),setTimeout("isgameover()",300))}}),document.addEventListener("touchstart",function(e){startx=e.touches[0].pageX,starty=e.touches[0].pageY}),document.addEventListener("touchend",function(e){endx=e.changedTouches[0].pageX,endy=e.changedTouches[0].pageY;var t=endx-startx,a=endy-starty;Math.abs(t)<.3*documentWidth&&Math.abs(a)<.3*documentWidth||(Math.abs(t)>=Math.abs(a)?t>0?moveRight()&&(setTimeout("generateOneNumber()",210),setTimeout("isgameover()",300)):moveLeft()&&(setTimeout("generateOneNumber()",210),setTimeout("isgameover()",300)):a>0?moveDown()&&(setTimeout("generateOneNumber()",210),setTimeout("isgameover()",300)):moveUp()&&(setTimeout("generateOneNumber()",210),setTimeout("isgameover()",300)))})}},music:{init:function(t){t.mk1=0;var a=[];$(document).on("click","[name='incode2']",function(){var e=$(this).parent().parent().index(),t=$("[name='incode']").eq(e).find("input").is(":checked");if(t)a.push($(this).val());else for(var i=0;i<a.length;i++)$(this).val()==a[i]&&a.splice(e-1,1)}),$(document).on("click","#ckeckAll",function(){for(var e=0,t=0;t<$("[name='incode']").length;t++)$("[name='incode']").eq(t).find("input").is(":checked")&&(e+=1);if(e==$("[name='incode']").length)$("[name='incode']").find("input").prop("checked",!1),a=[];else{$("[name='incode']").find("input").prop("checked",!0),$("#ckeckAll").prop("checked",!0);for(var i=0;i<$("[name='incode']").length;i++)a.push($("[name='incode']").eq(i).find("input").val())}}),t.com_del2.before=function(e){var t=a.join(",");e.com_del2.params.codeid=t},t.com_del2.done=function(t,i){a=[],1==t.code&&e.dogoto(t,"#music")},$(document).on("focus","#blog_search_text",function(){$(".mod_search").removeClass("bor2"),$(".mod_search").removeClass("bg"),$("#blog_search_text").removeClass("c_tx3"),$(".mod_search").addClass("mlmb_12"),$(".mod_search").addClass("textinput_focus")}),$(document).on("blur","#blog_search_text",function(){$(".mod_search").addClass("bor2"),$(".mod_search").addClass("bg"),$("#blog_search_text").addClass("c_tx3"),$(".mod_search").removeClass("mlmb_12"),$(".mod_search").removeClass("textinput_focus")}),$(document).on("click",".arr_wrap",function(){var e=$(this).parent().parent().parent().index(),t=$("#listAreaul").children("li").eq(e).find(".list_op").hasClass("show_more_op");$("#listAreaul").children("li").find(".list_op").removeClass("show_more_op"),t?$("#listAreaul").children("li").eq(e).find(".list_op").removeClass("show_more_op"):$("#listAreaul").children("li").eq(e).find(".list_op").addClass("show_more_op");var a=$("#listAreaul").children("li").eq(e).find(".mod_drop_op").css("display");$("#listAreaul").children("li").find(".mod_drop_op").hide(),"none"==a?$("#listAreaul").children("li").eq(e).find(".mod_drop_op").show():$("#listAreaul").children("li").eq(e).find(".mod_drop_op").hide();var i=$("#listAreaul").children("li").eq(e).find(".arr_wrap").hasClass("bg");$("#listAreaul").children("li").find(".arr_wrap").removeClass("bg"),$("#listAreaul").children("li").find(".arr_wrap").removeClass("bor2"),i?($(this).removeClass("bg"),$(this).removeClass("bor2")):($(this).addClass("bg"),$(this).addClass("bor2"))}),$(document).on("blur",".arr_wrap",function(){var e=$(this).parent().parent().parent().index();setTimeout(function(){$("#listAreaul").children("li").eq(e).find(".list_op").removeClass("show_more_op"),$("#listAreaul").children("li").eq(e).find(".mod_drop_op").hide(),$("#listAreaul").children("li").eq(e).find(".arr_wrap").removeClass("bg"),$("#listAreaul").children("li").eq(e).find(".arr_wrap").removeClass("bor2")},200)}),t.com_list_page.url="auth/mycom_list_page",t.com_list_page.params.codeid=e.getcd(t,"c1"),t.com_list_page.params.listnum=15,t.com_list_page.params.format=4,t.com_list_page.params.orderstrid=2,t.com_list_page.time=e.time(),t.com_list_page.done=function(t,a){a.total=t.code,a.com_editadd.params.format=4,a.com_editadd.url="auth/music_editadd",a.com_editadd.before=function(t){void 0==t.com_editadd.params.codeid&&(t.com_editadd.params.codeid=e.getcd(t,"c1")),t.com_editadd.params.format=4},a.com_editadd.done=function(t,a){e.dogoto(t,"#music")}}}},schedule:{init:function(t){t.mk1=0,t.schedulearray=[],t.dropcode="",$(document).ready(function(){setTimeout(function(){$(".i-checks").iCheck({checkboxClass:"icheckbox_square-green",radioClass:"iradio_square-green"});var a=new Date;a.getDate(),a.getMonth(),a.getFullYear();$("#calendar").fullCalendar({header:{left:"prev,next",center:"title",right:"month,agendaWeek,agendaDay"},editable:!0,droppable:!0,drop:function(a,i){var n=$(this).data("eventObject"),o=$.extend({},n);o.start=a,o.allDay=i;var c=$(this).index();if(""!==$.trim(t.schedulearray[c-1].end)&&parseInt(t.schedulearray[c-1].end))var d=parseInt(t.schedulearray[c-1].end);if(t.com_editadd.url="auth/mycom_editadd",t.com_editadd.params.codeid=e.getcd(t,"c2"),t.com_editadd.params.title=$(this).data("eventObject").title,t.com_editadd.params.start=a,""!==$.trim(d)){var r=a.getDate(),s=a.getMonth(),l=a.getFullYear();o.end=new Date(l,s,r+d-1),t.com_editadd.params.end=o.end}t.com_editadd.time=e.time(),t.com_editadd.done=function(e,t){1==e.code&&(t.dropcode=e.data)},$("#calendar").fullCalendar("renderEvent",o,!0),$("#drop-remove").is(":checked")&&($(this).remove(),t.schedulearray.splice(c-1,1)),t.$apply()},eventDrop:function(a,i,n,o,c,d,r,s){t.com_editadd2.url="auth/schedule_editadd",void 0==a.codeid?(t.com_editadd2.params.dropcode=t.dropcode,t.com_editadd2.params.codeid=""):(t.com_editadd2.params.codeid=a.codeid,t.com_editadd2.params.dropcode=""),t.com_editadd2.params.title=a.title,t.com_editadd2.params.start=a.start,""!==$.trim(a.end)&&(t.com_editadd2.params.end=a.end),o?t.com_editadd2.params.allDay=1:t.com_editadd2.params.allDay=0,t.com_editadd2.time=e.time(),t.$apply()},events:t.com_list.data})},200),$(document).on("click",".diarybutton",function(){var e=new Object;e={title:$("#blog_search_text").val(),end:$("#blog_search_text2").val()
},t.schedulearray.push(e),t.mk1=0,t.$apply(),$(".i-checks").iCheck({checkboxClass:"icheckbox_square-green",radioClass:"iradio_square-green"}),$("#external-events div.external-event").each(function(){var e={title:$.trim($(this).text())};$(this).data("eventObject",e),$(this).draggable({zIndex:999,revert:!0,revertDuration:0})})}),$(document).on("click","#xinzeng",function(){$(".i-checks").iCheck({checkboxClass:"icheckbox_square-green",radioClass:"iradio_square-green"})}),t.com_list.url="auth/mycom_list",t.com_list.params.codeid=e.getcd(t,"c2"),t.com_list.time=e.time(),t.com_list.done=function(e,t){if(1==e.code)for(var a=e.data.length-1;a>=0;a--)e.data[a].allDay=Boolean(e.data[a].allDay)}})}}};return t}]),app.directive("settype",["fac",function(e){return{link:function(t,a,i,n){a.on("click",function(){e.setstore("settype",i.settype)})}}}]);